# Drowsiness Detection System

## Features

- **Image Detection**: Analyze single images or batches of images for drowsiness
- **Real-time Detection**: Live webcam feed analysis with alert system
- **Batch Processing**: Process entire datasets for evaluation
- **Configurable**: Easy-to-modify detection parameters and thresholds
- **Visualization**: Save images with detection boxes and confidence scores

## Dataset

URL: https://universe.roboflow.com/lab502new/eyes-close-open-yawn-no-yawn

The roboflow dataset contains annotated images of the following classes:
   - No Yawn
   - Yawn
   - closed eyes
   - open eyes

### Data Folder Layout
```{bash}
data/
├─ train/
│  ├─ images/              # training images
│  └─ labels/              # YOLO txt labels (one per image)
│     └─ labels.cache      # (auto-generated by Ultralytics; optional)
├─ valid/
│  ├─ images/              # validation images
│  └─ labels/              # validation labels
│     └─ labels.cache      # (auto-generated)
├─ test/                   # optional split
│  ├─ images/
│  └─ labels/
└─ data.yaml            
```

## Installation

1. **Clone or download the project**
2. **Install Python dependencies**:
   ```bash
   pip install -r requirements.txt
   ```

## Docker Image Setup (Based on Ultralytics docker quickstart documentation)

### GPU specific Instructions
1. Verify if NVIDIA drivers are installed
   ```{r}
   nvidia-smi
   ```

2. Installing NVIDIA Container Toolkit
   ```{r}
      curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg \
   && curl -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list \
   | sed 's#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g' \
      | sudo tee /etc/apt/sources.list.d/nvidia-container-toolkit.list
   ```

3. Install Latest version of nvidia-container-toolkit
   ```{r}
   sudo apt-get install -y nvidia-container-toolkit \
   nvidia-container-toolkit-base libnvidia-container-tools \
   libnvidia-container1
   ```

   ```{r}
   sudo nvidia-ctk runtime configure --runtime=docker
   sudo systemctl restart docker
   ```

4. Verify NVIDIA Runtime with Docker
   ```{r}
   docker info | grep -i runtime
   ```

### Installing Ultralytics Docker Image
**To pull the latest image**:
   ```
   # Set image name as a variable
   t=ultralytics/ultralytics:latest

   # Pull the latest Ultralytics image from Docker Hub
   sudo docker pull $t
   ```

## Training

1. **Train YOLO model - Change parameters (if needed)**:
Note: The script also handles docker run
   ```{r}
   ./docker_training.ps1
   ```

2. **Get the model size**:
   ```{r}
   Get-Item .\runs\drowsy_run1\weights\best.pt | Select-Object Name, @{Name="Size (MB)";Expression={"{0:N2}" -f ($_.Length / 1MB)}}
   ```
